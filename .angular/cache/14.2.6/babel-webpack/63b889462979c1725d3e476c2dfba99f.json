{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/services/cart.service\";\nimport * as i2 from \"./../../services/product.service\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/router\";\nimport * as i5 from \"../add-to-cart/add-to-cart.component\";\nimport * as i6 from \"../product-image/product-image.component\";\nimport * as i7 from \"../product-name/product-name.component\";\nimport * as i8 from \"../product-price/product-price.component\";\n\nfunction CartComponent_div_0_a_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"a\", 8)(1, \"button\", 9);\n    i0.ɵɵtext(2, \"Checkout\");\n    i0.ɵɵelementEnd()();\n  }\n}\n\nfunction CartComponent_div_0_li_8_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"li\", 10);\n    i0.ɵɵelement(1, \"app-product-image\", 11);\n    i0.ɵɵelementStart(2, \"div\", 12);\n    i0.ɵɵelement(3, \"app-product-name\", 13)(4, \"app-product-price\", 14);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"app-add-to-cart\", 15);\n    i0.ɵɵlistener(\"updateQuantity\", function CartComponent_div_0_li_8_Template_app_add_to_cart_updateQuantity_5_listener($event) {\n      i0.ɵɵrestoreView(_r6);\n      const ctx_r5 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r5.updateQuantity($event));\n    })(\"deleteItem\", function CartComponent_div_0_li_8_Template_app_add_to_cart_deleteItem_5_listener($event) {\n      i0.ɵɵrestoreView(_r6);\n      const ctx_r7 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r7.deleteItem($event));\n    });\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const item_r4 = ctx.$implicit;\n    const ctx_r3 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"url\", item_r4.product.url);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"name\", item_r4.product.name);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"price\", item_r4.product.price);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"quantity\", item_r4.quantity)(\"productId\", item_r4.product.id)(\"inCart\", true)(\"inCheckout\", ctx_r3.checkout);\n  }\n}\n\nfunction CartComponent_div_0_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 1)(1, \"div\", 2)(2, \"label\", 3);\n    i0.ɵɵtext(3, \"Total: \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"p\", 4);\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(6, CartComponent_div_0_a_6_Template, 3, 0, \"a\", 5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"ul\", 6);\n    i0.ɵɵtemplate(8, CartComponent_div_0_li_8_Template, 6, 7, \"li\", 7);\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(ctx_r0.total);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r0.checkout);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.cart);\n  }\n}\n\nfunction CartComponent_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 1)(1, \"h1\");\n    i0.ɵɵtext(2, \"your cart is empty\");\n    i0.ɵɵelementEnd()();\n  }\n}\n\nclass CartItem {\n  constructor() {\n    this.product = {};\n    this.quantity = 0;\n  }\n\n}\n\nexport let CartComponent = /*#__PURE__*/(() => {\n  class CartComponent {\n    constructor(cartService, productService) {\n      this.cartService = cartService;\n      this.productService = productService;\n      this.cart = [];\n      this.products = [];\n      this.total = '';\n      this.checkout = false;\n    }\n\n    ngOnInit() {\n      const activeOrder = this.cartService.getCart();\n      this.productService.getProducts().subscribe(data => {\n        this.products = data;\n        activeOrder.items.forEach(item => {\n          const product = this.products.find(product => product.id == item.productId);\n          const cartItem = {\n            product: product,\n            quantity: item.quantity\n          }; // this.total += product.price * item.quantity\n\n          this.cart.push(cartItem);\n        });\n        this.updateTotal();\n        sessionStorage.setItem('total', this.total);\n      });\n    }\n\n    updateTotal() {\n      const dollarUS = Intl.NumberFormat('en-US', {\n        style: 'currency',\n        currency: 'USD'\n      });\n      const totalPrice = this.cart.reduce((total, item) => {\n        console.log(`In REDUCE: price: ${item.product.price}, quantity: ${item.quantity}`);\n        return total += item.product.price * item.quantity;\n      }, 0);\n      this.total = dollarUS.format(totalPrice);\n      console.log(`\\n NEW TOTAL: ${this.total}`);\n      sessionStorage.setItem('total', this.total);\n    }\n\n    deleteItem(productId) {\n      const item = this.cart.filter(item => item.product.id == productId)[0];\n      this.cart = this.cart.filter(item => item.product.id != productId);\n      this.cartService.deleteItem(productId);\n      this.updateTotal();\n      window.alert(`${item.product.name} was deleted from your cart.`);\n    }\n\n    updateQuantity(orderItem) {\n      const itemIndex = this.cart.findIndex(item => item.product.id == orderItem.productId);\n      this.cart[itemIndex].quantity = orderItem.quantity;\n      this.cartService.updateQuantity(orderItem.productId, orderItem.quantity);\n      this.updateTotal();\n    }\n\n  }\n\n  CartComponent.ɵfac = function CartComponent_Factory(t) {\n    return new (t || CartComponent)(i0.ɵɵdirectiveInject(i1.CartService), i0.ɵɵdirectiveInject(i2.ProductService));\n  };\n\n  CartComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: CartComponent,\n    selectors: [[\"app-cart\"]],\n    inputs: {\n      checkout: \"checkout\"\n    },\n    decls: 2,\n    vars: 2,\n    consts: [[\"class\", \"content\", 4, \"ngIf\"], [1, \"content\"], [1, \"summary\"], [\"for\", \"total\"], [1, \"total\"], [\"routerLink\", \"/checkout\", 4, \"ngIf\"], [1, \"cart\"], [\"class\", \"item\", 4, \"ngFor\", \"ngForOf\"], [\"routerLink\", \"/checkout\"], [\"type\", \"button\", 1, \"checkout\"], [1, \"item\"], [3, \"url\"], [1, \"details\"], [3, \"name\"], [3, \"price\"], [3, \"quantity\", \"productId\", \"inCart\", \"inCheckout\", \"updateQuantity\", \"deleteItem\"]],\n    template: function CartComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵtemplate(0, CartComponent_div_0_Template, 9, 3, \"div\", 0);\n        i0.ɵɵtemplate(1, CartComponent_div_1_Template, 3, 0, \"div\", 0);\n      }\n\n      if (rf & 2) {\n        i0.ɵɵproperty(\"ngIf\", ctx.cart.length > 0);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.cart.length == 0);\n      }\n    },\n    dependencies: [i3.NgForOf, i3.NgIf, i4.RouterLinkWithHref, i5.AddToCartComponent, i6.ProductImageComponent, i7.ProductNameComponent, i8.ProductPriceComponent],\n    styles: [\".content[_ngcontent-%COMP%]{padding:20px}.summary[_ngcontent-%COMP%]{padding-top:20px;text-align:center;font-size:1.3em}.summary[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{display:inline-block}label[_ngcontent-%COMP%]{font-weight:500;margin-right:10px}.total[_ngcontent-%COMP%]{font-weight:600;margin-right:50px}.checkout[_ngcontent-%COMP%]{background-color:orange;font-weight:600;color:#fff;font-size:inherit;padding:5px}.cart[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:wrap;justify-content:center}.item[_ngcontent-%COMP%]{width:40%;padding:10px}.details[_ngcontent-%COMP%]{display:flex;justify-content:space-between}form[_ngcontent-%COMP%], h1[_ngcontent-%COMP%]{text-align:center}@media (max-width: 450px){.item[_ngcontent-%COMP%]{width:100%}}@media (min-width: 450px){.details[_ngcontent-%COMP%]{display:block}}@media (min-width: 600px){.details[_ngcontent-%COMP%]{display:flex}}\"]\n  });\n  return CartComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}